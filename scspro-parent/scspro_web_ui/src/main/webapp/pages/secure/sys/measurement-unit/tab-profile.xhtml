<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" 
        xmlns:h="http://xmlns.jcp.org/jsf/html" 
        xmlns:f="http://xmlns.jcp.org/jsf/core" 
        xmlns:ui="http://xmlns.jcp.org/jsf/facelets" 
        xmlns:pt="http://xmlns.jcp.org/jsf/passthrough" 
        xmlns:p="http://primefaces.org/ui">
    <div class="row" style="margin-top:15px;">
        <div class="control-group col-md-12">
            <!-- TODO: Ajax update for both -->
            <!-- TODO: Get actual records from database -->
            <p:growl id="growl" escape="false"/>
            <h:panelGroup id="availableRoles" layout="block" styleClass="panel panel-primary" style="overflow:hidden;">
                <p class="panel-heading">#{i18n_measurement_unit['measurementUnit.profiles.available']}</p>
                <h:panelGroup layout="block" style="padding:10px;" rendered="#{empty measurementUnitBean.availableRoles}">
                    #{i18n_measurement_unit['measurementUnit.profiles.allAssigned']}
                </h:panelGroup>
                <ui:repeat var="item" value="#{measurementUnitBean.availableRoles}" rendered="#{not empty measurementUnitBean.availableRoles}">
                    <h:panelGroup id="item" styleClass="btn btn-primary" style="margin:5px;">
                        <f:attribute name="measurementRole" value="#{item}"/>
                        <h:outputText value="#{item.displayName}" />
                    </h:panelGroup>
                    <p:draggable for="item" revert="true" cursor="move" opacity="0.3" helper="clone" />
                </ui:repeat>
                <p:droppable id="dropSelected" for="availableRoles" accept=".btn-success" tolerance="touch" activeStyleClass="panel-selected">
                    <p:ajax listener="#{measurementUnitBean.onRemoveRole}" update="availableRoles selectedRoles growl" />
                </p:droppable>
            </h:panelGroup>

            <h:panelGroup id="selectedRoles" layout="block" styleClass="panel panel-primary" style="overflow:hidden;">
                <p class="panel-heading">#{i18n_measurement_unit['measurementUnit.profiles.selected']}</p>
                <h:panelGroup layout="block" style="padding:10px;" rendered="#{empty measurementUnitBean.rolesList}">
                    #{i18n_measurement_unit['measurementUnit.profiles.empty']}
                </h:panelGroup>
                <ui:repeat var="item" value="#{measurementUnitBean.rolesList}" rendered="#{not empty measurementUnitBean.rolesList}">
                    <h:panelGroup id="item" styleClass="btn btn-success" style="margin:5px;">
                        <f:attribute name="measurementRole" value="#{item}"/>
                        <h:outputText value="#{item.displayName}" />
                    </h:panelGroup>
                    <p:draggable for="item" revert="true" cursor="move" opacity="0.3" helper="clone"  />
                </ui:repeat>
                <p:droppable id="dropAvailable" for="selectedRoles" accept=".btn-primary" tolerance="touch" activeStyleClass="panel-selected">
                    <p:ajax listener="#{measurementUnitBean.onAddRole}" update="availableRoles selectedRoles growl" />
                </p:droppable>
            </h:panelGroup>
        </div>
    </div>
    <script>
        function handleDrop(event, ui) {
            var droppedProfile = ui.draggable;
            droppedProfile.fadeOut('fast');
        }
    </script>
</html>
